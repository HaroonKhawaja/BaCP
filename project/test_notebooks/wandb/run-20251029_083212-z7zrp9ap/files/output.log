[34m[1mwandb[0m: Detected [huggingface_hub.inference] in use.
[34m[1mwandb[0m: Use W&B Weave for improved LLM call tracing. Install Weave with `pip install weave` then add `import weave` to the top of your script.
[34m[1mwandb[0m: For more information, check out the docs at: https://weave-docs.wandb.ai/
[Pruner] Fraction of weights to prune/regrow is 0.30000000.
[Pruner] Fraction of weights to prune/regrow is 0.30000000.
[Pruner] Fraction of weights to prune/regrow is 0.30000000.
Epoch [1/50] - Total Loss: 8.2063 - PrC Loss: 3.8850 - SnC Loss: 0.0000 - FiC Loss: 3.7527 - CE Loss: 0.5686 - Training Accuracy: 13.8522 - sparsity: 0.9900
[TRAINER] weights saved!
[Pruner] Fraction of weights to prune/regrow is 0.29932079.
[Pruner] Fraction of weights to prune/regrow is 0.29932079.
[Pruner] Fraction of weights to prune/regrow is 0.29932079.
[Pruner] Fraction of weights to prune/regrow is 0.29932079.
Epoch [2/50] - Total Loss: 10.7800 - PrC Loss: 3.8156 - SnC Loss: 2.7446 - FiC Loss: 3.6683 - CE Loss: 0.5515 - Training Accuracy: 15.6971 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.29728931.
[Pruner] Fraction of weights to prune/regrow is 0.29728931.
[Pruner] Fraction of weights to prune/regrow is 0.29728931.
[Pruner] Fraction of weights to prune/regrow is 0.29728931.
Epoch [3/50] - Total Loss: 10.7922 - PrC Loss: 3.8168 - SnC Loss: 2.7550 - FiC Loss: 3.6683 - CE Loss: 0.5521 - Training Accuracy: 15.6370 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.29392394.
[Pruner] Fraction of weights to prune/regrow is 0.29392394.
[Pruner] Fraction of weights to prune/regrow is 0.29392394.
[Pruner] Fraction of weights to prune/regrow is 0.29392394.
Epoch [4/50] - Total Loss: 10.7982 - PrC Loss: 3.8181 - SnC Loss: 2.7635 - FiC Loss: 3.6646 - CE Loss: 0.5520 - Training Accuracy: 15.3325 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.28925518.
[Pruner] Fraction of weights to prune/regrow is 0.28925518.
[Pruner] Fraction of weights to prune/regrow is 0.28925518.
[Pruner] Fraction of weights to prune/regrow is 0.28925518.
Epoch [5/50] - Total Loss: 10.7702 - PrC Loss: 3.8039 - SnC Loss: 2.7781 - FiC Loss: 3.6461 - CE Loss: 0.5422 - Training Accuracy: 16.9792 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.28332531.
[Pruner] Fraction of weights to prune/regrow is 0.28332531.
[Pruner] Fraction of weights to prune/regrow is 0.28332531.
[Pruner] Fraction of weights to prune/regrow is 0.28332531.
Epoch [6/50] - Total Loss: 10.5528 - PrC Loss: 3.7351 - SnC Loss: 2.7674 - FiC Loss: 3.5499 - CE Loss: 0.5003 - Training Accuracy: 24.4872 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.27618803.
[Pruner] Fraction of weights to prune/regrow is 0.27618803.
[Pruner] Fraction of weights to prune/regrow is 0.27618803.
[Pruner] Fraction of weights to prune/regrow is 0.27618803.
Epoch [7/50] - Total Loss: 10.4114 - PrC Loss: 3.6931 - SnC Loss: 2.7613 - FiC Loss: 3.4827 - CE Loss: 0.4742 - Training Accuracy: 29.8878 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.26790796.
[Pruner] Fraction of weights to prune/regrow is 0.26790796.
[Pruner] Fraction of weights to prune/regrow is 0.26790796.
[Pruner] Fraction of weights to prune/regrow is 0.26790796.
Epoch [8/50] - Total Loss: 10.3021 - PrC Loss: 3.6544 - SnC Loss: 2.7588 - FiC Loss: 3.4326 - CE Loss: 0.4563 - Training Accuracy: 33.1951 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.25856010.
[Pruner] Fraction of weights to prune/regrow is 0.25856010.
[Pruner] Fraction of weights to prune/regrow is 0.25856010.
[Pruner] Fraction of weights to prune/regrow is 0.25856010.
Epoch [9/50] - Total Loss: 10.1913 - PrC Loss: 3.6165 - SnC Loss: 2.7524 - FiC Loss: 3.3847 - CE Loss: 0.4377 - Training Accuracy: 36.5625 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.24822911.
[Pruner] Fraction of weights to prune/regrow is 0.24822911.
[Pruner] Fraction of weights to prune/regrow is 0.24822911.
[Pruner] Fraction of weights to prune/regrow is 0.24822911.
Epoch [10/50] - Total Loss: 10.1071 - PrC Loss: 3.5950 - SnC Loss: 2.7395 - FiC Loss: 3.3505 - CE Loss: 0.4220 - Training Accuracy: 39.3490 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.23700854.
[Pruner] Fraction of weights to prune/regrow is 0.23700854.
[Pruner] Fraction of weights to prune/regrow is 0.23700854.
Epoch [11/50] - Total Loss: 10.0409 - PrC Loss: 3.5781 - SnC Loss: 2.7253 - FiC Loss: 3.3282 - CE Loss: 0.4092 - Training Accuracy: 41.7107 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.22500000.
[Pruner] Fraction of weights to prune/regrow is 0.22500000.
[Pruner] Fraction of weights to prune/regrow is 0.22500000.
[Pruner] Fraction of weights to prune/regrow is 0.22500000.
Epoch [12/50] - Total Loss: 9.9887 - PrC Loss: 3.5682 - SnC Loss: 2.7082 - FiC Loss: 3.3143 - CE Loss: 0.3981 - Training Accuracy: 43.1450 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.21231226.
[Pruner] Fraction of weights to prune/regrow is 0.21231226.
[Pruner] Fraction of weights to prune/regrow is 0.21231226.
[Pruner] Fraction of weights to prune/regrow is 0.21231226.
Epoch [13/50] - Total Loss: 9.9301 - PrC Loss: 3.5601 - SnC Loss: 2.6892 - FiC Loss: 3.2936 - CE Loss: 0.3871 - Training Accuracy: 44.8478 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.19906020.
[Pruner] Fraction of weights to prune/regrow is 0.19906020.
[Pruner] Fraction of weights to prune/regrow is 0.19906020.
[Pruner] Fraction of weights to prune/regrow is 0.19906020.
Epoch [14/50] - Total Loss: 9.8905 - PrC Loss: 3.5496 - SnC Loss: 2.6727 - FiC Loss: 3.2871 - CE Loss: 0.3811 - Training Accuracy: 45.9575 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.18536384.
[Pruner] Fraction of weights to prune/regrow is 0.18536384.
[Pruner] Fraction of weights to prune/regrow is 0.18536384.
[Pruner] Fraction of weights to prune/regrow is 0.18536384.
Epoch [15/50] - Total Loss: 9.8498 - PrC Loss: 3.5421 - SnC Loss: 2.6592 - FiC Loss: 3.2728 - CE Loss: 0.3757 - Training Accuracy: 46.7208 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.17134724.
[Pruner] Fraction of weights to prune/regrow is 0.17134724.
[Pruner] Fraction of weights to prune/regrow is 0.17134724.
[Pruner] Fraction of weights to prune/regrow is 0.17134724.
Epoch [16/50] - Total Loss: 9.8188 - PrC Loss: 3.5352 - SnC Loss: 2.6481 - FiC Loss: 3.2639 - CE Loss: 0.3716 - Training Accuracy: 47.5982 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.15713729.
[Pruner] Fraction of weights to prune/regrow is 0.15713729.
[Pruner] Fraction of weights to prune/regrow is 0.15713729.
[Pruner] Fraction of weights to prune/regrow is 0.15713729.
Epoch [17/50] - Total Loss: 9.7862 - PrC Loss: 3.5284 - SnC Loss: 2.6352 - FiC Loss: 3.2569 - CE Loss: 0.3657 - Training Accuracy: 48.5998 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.14286270.
[Pruner] Fraction of weights to prune/regrow is 0.14286270.
[Pruner] Fraction of weights to prune/regrow is 0.14286270.
[Pruner] Fraction of weights to prune/regrow is 0.14286270.
Epoch [18/50] - Total Loss: 9.7581 - PrC Loss: 3.5270 - SnC Loss: 2.6232 - FiC Loss: 3.2481 - CE Loss: 0.3599 - Training Accuracy: 49.3570 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.12865277.
[Pruner] Fraction of weights to prune/regrow is 0.12865277.
[Pruner] Fraction of weights to prune/regrow is 0.12865277.
[Pruner] Fraction of weights to prune/regrow is 0.12865277.
Epoch [19/50] - Total Loss: 9.7345 - PrC Loss: 3.5226 - SnC Loss: 2.6119 - FiC Loss: 3.2427 - CE Loss: 0.3573 - Training Accuracy: 50.0200 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.11463616.
[Pruner] Fraction of weights to prune/regrow is 0.11463616.
[Pruner] Fraction of weights to prune/regrow is 0.11463616.
[Pruner] Fraction of weights to prune/regrow is 0.11463616.
Epoch [20/50] - Total Loss: 9.7148 - PrC Loss: 3.5206 - SnC Loss: 2.6011 - FiC Loss: 3.2401 - CE Loss: 0.3530 - Training Accuracy: 50.4427 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.10093979.
[Pruner] Fraction of weights to prune/regrow is 0.10093979.
[Pruner] Fraction of weights to prune/regrow is 0.10093979.
Epoch [21/50] - Total Loss: 9.6874 - PrC Loss: 3.5172 - SnC Loss: 2.5915 - FiC Loss: 3.2307 - CE Loss: 0.3481 - Training Accuracy: 50.8193 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.08768772.
[Pruner] Fraction of weights to prune/regrow is 0.08768772.
[Pruner] Fraction of weights to prune/regrow is 0.08768772.
[Pruner] Fraction of weights to prune/regrow is 0.08768772.
Epoch [22/50] - Total Loss: 9.6781 - PrC Loss: 3.5180 - SnC Loss: 2.5843 - FiC Loss: 3.2294 - CE Loss: 0.3464 - Training Accuracy: 51.3682 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.07499999.
[Pruner] Fraction of weights to prune/regrow is 0.07499999.
[Pruner] Fraction of weights to prune/regrow is 0.07499999.
[Pruner] Fraction of weights to prune/regrow is 0.07499999.
Epoch [23/50] - Total Loss: 9.6520 - PrC Loss: 3.5097 - SnC Loss: 2.5733 - FiC Loss: 3.2263 - CE Loss: 0.3427 - Training Accuracy: 51.9291 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.06299148.
[Pruner] Fraction of weights to prune/regrow is 0.06299148.
[Pruner] Fraction of weights to prune/regrow is 0.06299148.
[Pruner] Fraction of weights to prune/regrow is 0.06299148.
Epoch [24/50] - Total Loss: 9.6411 - PrC Loss: 3.5122 - SnC Loss: 2.5657 - FiC Loss: 3.2226 - CE Loss: 0.3406 - Training Accuracy: 52.0933 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.05177090.
[Pruner] Fraction of weights to prune/regrow is 0.05177090.
[Pruner] Fraction of weights to prune/regrow is 0.05177090.
[Pruner] Fraction of weights to prune/regrow is 0.05177090.
Epoch [25/50] - Total Loss: 9.6272 - PrC Loss: 3.5066 - SnC Loss: 2.5586 - FiC Loss: 3.2211 - CE Loss: 0.3409 - Training Accuracy: 52.1114 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.04143990.
[Pruner] Fraction of weights to prune/regrow is 0.04143990.
[Pruner] Fraction of weights to prune/regrow is 0.04143990.
[Pruner] Fraction of weights to prune/regrow is 0.04143990.
Epoch [26/50] - Total Loss: 9.6137 - PrC Loss: 3.5084 - SnC Loss: 2.5497 - FiC Loss: 3.2181 - CE Loss: 0.3375 - Training Accuracy: 52.8946 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.03209203.
[Pruner] Fraction of weights to prune/regrow is 0.03209203.
[Pruner] Fraction of weights to prune/regrow is 0.03209203.
[Pruner] Fraction of weights to prune/regrow is 0.03209203.
Epoch [27/50] - Total Loss: 9.5969 - PrC Loss: 3.5039 - SnC Loss: 2.5444 - FiC Loss: 3.2137 - CE Loss: 0.3349 - Training Accuracy: 53.2131 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.02381196.
[Pruner] Fraction of weights to prune/regrow is 0.02381196.
[Pruner] Fraction of weights to prune/regrow is 0.02381196.
[Pruner] Fraction of weights to prune/regrow is 0.02381196.
Epoch [28/50] - Total Loss: 9.5827 - PrC Loss: 3.5050 - SnC Loss: 2.5343 - FiC Loss: 3.2109 - CE Loss: 0.3324 - Training Accuracy: 53.4996 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.01667468.
[Pruner] Fraction of weights to prune/regrow is 0.01667468.
[Pruner] Fraction of weights to prune/regrow is 0.01667468.
[Pruner] Fraction of weights to prune/regrow is 0.01667468.
Epoch [29/50] - Total Loss: 9.5731 - PrC Loss: 3.5039 - SnC Loss: 2.5299 - FiC Loss: 3.2073 - CE Loss: 0.3320 - Training Accuracy: 53.6599 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.01074481.
[Pruner] Fraction of weights to prune/regrow is 0.01074481.
[Pruner] Fraction of weights to prune/regrow is 0.01074481.
[Pruner] Fraction of weights to prune/regrow is 0.01074481.
Epoch [30/50] - Total Loss: 9.5577 - PrC Loss: 3.5020 - SnC Loss: 2.5224 - FiC Loss: 3.2048 - CE Loss: 0.3284 - Training Accuracy: 54.2268 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.00607605.
[Pruner] Fraction of weights to prune/regrow is 0.00607605.
[Pruner] Fraction of weights to prune/regrow is 0.00607605.
Epoch [31/50] - Total Loss: 9.5532 - PrC Loss: 3.5031 - SnC Loss: 2.5176 - FiC Loss: 3.2038 - CE Loss: 0.3287 - Training Accuracy: 54.1667 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.00271069.
[Pruner] Fraction of weights to prune/regrow is 0.00271069.
[Pruner] Fraction of weights to prune/regrow is 0.00271069.
[Pruner] Fraction of weights to prune/regrow is 0.00271069.
Epoch [32/50] - Total Loss: 9.5423 - PrC Loss: 3.5048 - SnC Loss: 2.5100 - FiC Loss: 3.2007 - CE Loss: 0.3268 - Training Accuracy: 54.2728 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.00067922.
[Pruner] Fraction of weights to prune/regrow is 0.00067922.
[Pruner] Fraction of weights to prune/regrow is 0.00067922.
[Pruner] Fraction of weights to prune/regrow is 0.00067922.
Epoch [33/50] - Total Loss: 9.5349 - PrC Loss: 3.5051 - SnC Loss: 2.5039 - FiC Loss: 3.2015 - CE Loss: 0.3245 - Training Accuracy: 54.7115 - sparsity: 0.9900
[Pruner] Fraction of weights to prune/regrow is 0.00000000.
[Pruner] Fraction of weights to prune/regrow is 0.00000000.
[Pruner] Fraction of weights to prune/regrow is 0.00000000.
[Pruner] Fraction of weights to prune/regrow is 0.00000000.
Epoch [34/50] - Total Loss: 9.5088 - PrC Loss: 3.4942 - SnC Loss: 2.4966 - FiC Loss: 3.1959 - CE Loss: 0.3221 - Training Accuracy: 54.8117 - sparsity: 0.9900
Epoch [35/50] - Total Loss: 9.5112 - PrC Loss: 3.4984 - SnC Loss: 2.4950 - FiC Loss: 3.1947 - CE Loss: 0.3230 - Training Accuracy: 54.9219 - sparsity: 0.9900
Epoch [36/50] - Total Loss: 9.4937 - PrC Loss: 3.4902 - SnC Loss: 2.4897 - FiC Loss: 3.1925 - CE Loss: 0.3213 - Training Accuracy: 55.1002 - sparsity: 0.9900
Epoch [37/50] - Total Loss: 9.4958 - PrC Loss: 3.4965 - SnC Loss: 2.4860 - FiC Loss: 3.1929 - CE Loss: 0.3204 - Training Accuracy: 55.1643 - sparsity: 0.9900
Epoch [38/50] - Total Loss: 9.4854 - PrC Loss: 3.4951 - SnC Loss: 2.4804 - FiC Loss: 3.1901 - CE Loss: 0.3199 - Training Accuracy: 55.4447 - sparsity: 0.9900
Epoch [39/50] - Total Loss: 9.4797 - PrC Loss: 3.4952 - SnC Loss: 2.4766 - FiC Loss: 3.1894 - CE Loss: 0.3186 - Training Accuracy: 55.3706 - sparsity: 0.9900
Epoch [40/50] - Total Loss: 9.4706 - PrC Loss: 3.4934 - SnC Loss: 2.4717 - FiC Loss: 3.1886 - CE Loss: 0.3170 - Training Accuracy: 55.8474 - sparsity: 0.9900
Epoch [41/50] - Total Loss: 9.4731 - PrC Loss: 3.4954 - SnC Loss: 2.4696 - FiC Loss: 3.1918 - CE Loss: 0.3163 - Training Accuracy: 55.9295 - sparsity: 0.9900
Epoch [42/50] - Total Loss: 9.4623 - PrC Loss: 3.4896 - SnC Loss: 2.4651 - FiC Loss: 3.1910 - CE Loss: 0.3165 - Training Accuracy: 56.0717 - sparsity: 0.9900
Epoch [43/50] - Total Loss: 9.4610 - PrC Loss: 3.4917 - SnC Loss: 2.4629 - FiC Loss: 3.1894 - CE Loss: 0.3169 - Training Accuracy: 55.9295 - sparsity: 0.9900
Epoch [44/50] - Total Loss: 9.4492 - PrC Loss: 3.4880 - SnC Loss: 2.4581 - FiC Loss: 3.1864 - CE Loss: 0.3166 - Training Accuracy: 55.9435 - sparsity: 0.9900
Epoch [45/50] - Total Loss: 9.4453 - PrC Loss: 3.4889 - SnC Loss: 2.4537 - FiC Loss: 3.1876 - CE Loss: 0.3152 - Training Accuracy: 56.0717 - sparsity: 0.9900
Epoch [46/50] - Total Loss: 9.4452 - PrC Loss: 3.4968 - SnC Loss: 2.4499 - FiC Loss: 3.1853 - CE Loss: 0.3133 - Training Accuracy: 56.3682 - sparsity: 0.9900
Epoch [47/50] - Total Loss: 9.4395 - PrC Loss: 3.4900 - SnC Loss: 2.4491 - FiC Loss: 3.1856 - CE Loss: 0.3149 - Training Accuracy: 56.3001 - sparsity: 0.9900
Epoch [48/50] - Total Loss: 9.4317 - PrC Loss: 3.4905 - SnC Loss: 2.4458 - FiC Loss: 3.1816 - CE Loss: 0.3138 - Training Accuracy: 56.4403 - sparsity: 0.9900
Epoch [49/50] - Total Loss: 9.4285 - PrC Loss: 3.4893 - SnC Loss: 2.4415 - FiC Loss: 3.1848 - CE Loss: 0.3129 - Training Accuracy: 56.5665 - sparsity: 0.9900
Epoch [50/50] - Total Loss: 9.4203 - PrC Loss: 3.4899 - SnC Loss: 2.4382 - FiC Loss: 3.1805 - CE Loss: 0.3117 - Training Accuracy: 56.5725 - sparsity: 0.9900
Traceback (most recent call last):
  File "/Workspace/Users/haroon.khawaja@outlook.com/BaCP/project/test_notebooks/../scripts/bacp_script.py", line 41, in run_training
    bacp_trainer.train(run)
  File "/Workspace/Users/haroon.khawaja@outlook.com/BaCP/project/bacp.py", line 175, in train
    self.finetune(run)
  File "/Workspace/Users/haroon.khawaja@outlook.com/BaCP/project/bacp.py", line 310, in finetune
    self.pruner = self.get_pruner()
                  ^^^^^^^^^^^^^^^^^
  File "/Workspace/Users/haroon.khawaja@outlook.com/BaCP/project/bacp.py", line 583, in get_pruner
    pruning_module = PRUNER_DICT[self.pruning_type](
                     ^^^^^^^^^^^
NameError: name 'PRUNER_DICT' is not defined
