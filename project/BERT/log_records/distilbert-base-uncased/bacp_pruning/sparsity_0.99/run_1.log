Model : distilbert-base-uncased - Learning Type: bacp_pruning/sparsity_0.99
Configuration:
model_type: llm
model_name: distilbert-base-uncased
model_task: sst2
epochs: 10
pruning_epochs: 10
recovery_epochs: 5
batch_size: 64
learning_rate: 2e-05
pruning_type: magnitude_pruning
target_sparsity: 0.99
n_views: 2
temperature: 0.07
base_temperature: 0.07
num_classes: 2
lambda1: 0.25
lambda2: 0.25
lambda3: 0.25
lambda4: 0.25
embedding_dim: 768
save_path: {'current_model': '/dbfs/research/distilbert-base-uncased/sst2/distilbert-base-uncased_magnitude_pruning_0.99_bacp_cm.pt', 'pretrained_model': '/dbfs/research/distilbert-base-uncased/sst2/distilbert-base-uncased_magnitude_pruning_0.99_bacp_pm.pt', 'finetuned_model': '/dbfs/research/distilbert-base-uncased/sst2/distilbert-base-uncased_magnitude_pruning_0.99_bacp_fm.pt'}

Epoch [1/10]: Avg Total Loss: 5.2716 | Avg PrC Loss: 10.2855 | Avg SnC Loss: 0.0000 | Avg FiC Loss: 10.2069 | Avg CE Loss: 0.5939 | Model Sparsity: 0.620
Retraining Epoch [1/5]: Avg Total Loss: 6.8400 | Avg PrC Loss: 10.3659 | Avg SnC Loss: 6.7425 | Avg FiC Loss: 9.8487 | Avg CE Loss: 0.4028 | Model Sparsity: 0.620Retraining Epoch [2/5]: Avg Total Loss: 6.7160 | Avg PrC Loss: 10.3166 | Avg SnC Loss: 6.6886 | Avg FiC Loss: 9.6098 | Avg CE Loss: 0.2490 | Model Sparsity: 0.620Retraining Epoch [3/5]: Avg Total Loss: 6.6593 | Avg PrC Loss: 10.2892 | Avg SnC Loss: 6.6670 | Avg FiC Loss: 9.5072 | Avg CE Loss: 0.1739 | Model Sparsity: 0.620Retraining Epoch [4/5]: Avg Total Loss: 6.6258 | Avg PrC Loss: 10.2724 | Avg SnC Loss: 6.6521 | Avg FiC Loss: 9.4459 | Avg CE Loss: 0.1327 | Model Sparsity: 0.620Retraining Epoch [5/5]: Avg Total Loss: 6.6020 | Avg PrC Loss: 10.2550 | Avg SnC Loss: 6.6435 | Avg FiC Loss: 9.4031 | Avg CE Loss: 0.1062 | Model Sparsity: 0.620Epoch [2/10]: Avg Total Loss: 6.6735 | Avg PrC Loss: 10.2922 | Avg SnC Loss: 6.8041 | Avg FiC Loss: 9.4900 | Avg CE Loss: 0.1077 | Model Sparsity: 0.852
Retraining Epoch [1/5]: Avg Total Loss: 8.5306 | Avg PrC Loss: 10.4071 | Avg SnC Loss: 13.5705 | Avg FiC Loss: 9.9312 | Avg CE Loss: 0.2134 | Model Sparsity: 0.852Retraining Epoch [2/5]: Avg Total Loss: 8.3987 | Avg PrC Loss: 10.3625 | Avg SnC Loss: 13.3957 | Avg FiC Loss: 9.6878 | Avg CE Loss: 0.1488 | Model Sparsity: 0.852Retraining Epoch [3/5]: Avg Total Loss: 8.3533 | Avg PrC Loss: 10.3444 | Avg SnC Loss: 13.3369 | Avg FiC Loss: 9.6087 | Avg CE Loss: 0.1234 | Model Sparsity: 0.852Retraining Epoch [4/5]: Avg Total Loss: 8.3209 | Avg PrC Loss: 10.3267 | Avg SnC Loss: 13.2938 | Avg FiC Loss: 9.5573 | Avg CE Loss: 0.1057 | Model Sparsity: 0.852Retraining Epoch [5/5]: Avg Total Loss: 8.2990 | Avg PrC Loss: 10.3161 | Avg SnC Loss: 13.2666 | Avg FiC Loss: 9.5193 | Avg CE Loss: 0.0942 | Model Sparsity: 0.852Epoch [3/10]: Avg Total Loss: 8.4186 | Avg PrC Loss: 10.3506 | Avg SnC Loss: 13.5848 | Avg FiC Loss: 9.6257 | Avg CE Loss: 0.1131 | Model Sparsity: 0.939
Retraining Epoch [1/5]: Avg Total Loss: 10.2739 | Avg PrC Loss: 10.4294 | Avg SnC Loss: 20.3945 | Avg FiC Loss: 10.0256 | Avg CE Loss: 0.2462 | Model Sparsity: 0.939Retraining Epoch [2/5]: Avg Total Loss: 10.1027 | Avg PrC Loss: 10.3931 | Avg SnC Loss: 20.0483 | Avg FiC Loss: 9.7977 | Avg CE Loss: 0.1717 | Model Sparsity: 0.939Retraining Epoch [3/5]: Avg Total Loss: 10.0396 | Avg PrC Loss: 10.3705 | Avg SnC Loss: 19.9428 | Avg FiC Loss: 9.7042 | Avg CE Loss: 0.1407 | Model Sparsity: 0.939Retraining Epoch [4/5]: Avg Total Loss: 9.9995 | Avg PrC Loss: 10.3595 | Avg SnC Loss: 19.8706 | Avg FiC Loss: 9.6450 | Avg CE Loss: 0.1228 | Model Sparsity: 0.939Retraining Epoch [5/5]: Avg Total Loss: 9.9725 | Avg PrC Loss: 10.3474 | Avg SnC Loss: 19.8176 | Avg FiC Loss: 9.6126 | Avg CE Loss: 0.1123 | Model Sparsity: 0.939Epoch [4/10]: Avg Total Loss: 10.1352 | Avg PrC Loss: 10.3898 | Avg SnC Loss: 20.2682 | Avg FiC Loss: 9.7234 | Avg CE Loss: 0.1595 | Model Sparsity: 0.971
Retraining Epoch [1/5]: Avg Total Loss: 11.8192 | Avg PrC Loss: 10.4239 | Avg SnC Loss: 26.7230 | Avg FiC Loss: 9.9082 | Avg CE Loss: 0.2216 | Model Sparsity: 0.971Retraining Epoch [2/5]: Avg Total Loss: 11.6754 | Avg PrC Loss: 10.3873 | Avg SnC Loss: 26.3882 | Avg FiC Loss: 9.7549 | Avg CE Loss: 0.1713 | Model Sparsity: 0.971Retraining Epoch [3/5]: Avg Total Loss: 11.6154 | Avg PrC Loss: 10.3761 | Avg SnC Loss: 26.2585 | Avg FiC Loss: 9.6814 | Avg CE Loss: 0.1455 | Model Sparsity: 0.971Retraining Epoch [4/5]: Avg Total Loss: 11.5788 | Avg PrC Loss: 10.3659 | Avg SnC Loss: 26.1762 | Avg FiC Loss: 9.6429 | Avg CE Loss: 0.1301 | Model Sparsity: 0.971Retraining Epoch [5/5]: Avg Total Loss: 11.5539 | Avg PrC Loss: 10.3588 | Avg SnC Loss: 26.1221 | Avg FiC Loss: 9.6163 | Avg CE Loss: 0.1184 | Model Sparsity: 0.971Epoch [5/10]: Avg Total Loss: 11.7105 | Avg PrC Loss: 10.3920 | Avg SnC Loss: 26.5400 | Avg FiC Loss: 9.7282 | Avg CE Loss: 0.1819 | Model Sparsity: 0.983
Retraining Epoch [1/5]: Avg Total Loss: 13.2798 | Avg PrC Loss: 10.3981 | Avg SnC Loss: 32.7405 | Avg FiC Loss: 9.7974 | Avg CE Loss: 0.1831 | Model Sparsity: 0.983Retraining Epoch [2/5]: Avg Total Loss: 13.1651 | Avg PrC Loss: 10.3751 | Avg SnC Loss: 32.4537 | Avg FiC Loss: 9.6803 | Avg CE Loss: 0.1511 | Model Sparsity: 0.983Retraining Epoch [3/5]: Avg Total Loss: 13.1190 | Avg PrC Loss: 10.3688 | Avg SnC Loss: 32.3430 | Avg FiC Loss: 9.6319 | Avg CE Loss: 0.1323 | Model Sparsity: 0.983Retraining Epoch [4/5]: Avg Total Loss: 13.0870 | Avg PrC Loss: 10.3612 | Avg SnC Loss: 32.2658 | Avg FiC Loss: 9.6011 | Avg CE Loss: 0.1200 | Model Sparsity: 0.983Retraining Epoch [5/5]: Avg Total Loss: 13.0638 | Avg PrC Loss: 10.3533 | Avg SnC Loss: 32.2130 | Avg FiC Loss: 9.5775 | Avg CE Loss: 0.1115 | Model Sparsity: 0.983Epoch [6/10]: Avg Total Loss: 13.1777 | Avg PrC Loss: 10.3738 | Avg SnC Loss: 32.4665 | Avg FiC Loss: 9.6824 | Avg CE Loss: 0.1882 | Model Sparsity: 0.987
Retraining Epoch [1/5]: Avg Total Loss: 14.6677 | Avg PrC Loss: 10.3712 | Avg SnC Loss: 38.4891 | Avg FiC Loss: 9.6614 | Avg CE Loss: 0.1492 | Model Sparsity: 0.987Retraining Epoch [2/5]: Avg Total Loss: 14.5998 | Avg PrC Loss: 10.3641 | Avg SnC Loss: 38.3107 | Avg FiC Loss: 9.5957 | Avg CE Loss: 0.1285 | Model Sparsity: 0.987Retraining Epoch [3/5]: Avg Total Loss: 14.5694 | Avg PrC Loss: 10.3514 | Avg SnC Loss: 38.2368 | Avg FiC Loss: 9.5707 | Avg CE Loss: 0.1187 | Model Sparsity: 0.987Retraining Epoch [4/5]: Avg Total Loss: 14.5472 | Avg PrC Loss: 10.3508 | Avg SnC Loss: 38.1760 | Avg FiC Loss: 9.5515 | Avg CE Loss: 0.1105 | Model Sparsity: 0.987Retraining Epoch [5/5]: Avg Total Loss: 14.5355 | Avg PrC Loss: 10.3444 | Avg SnC Loss: 38.1508 | Avg FiC Loss: 9.5415 | Avg CE Loss: 0.1055 | Model Sparsity: 0.987Epoch [7/10]: Avg Total Loss: 14.5560 | Avg PrC Loss: 10.3506 | Avg SnC Loss: 38.2051 | Avg FiC Loss: 9.5565 | Avg CE Loss: 0.1118 | Model Sparsity: 0.989
Retraining Epoch [1/5]: Avg Total Loss: 16.0224 | Avg PrC Loss: 10.3604 | Avg SnC Loss: 44.1027 | Avg FiC Loss: 9.5274 | Avg CE Loss: 0.0992 | Model Sparsity: 0.989Retraining Epoch [2/5]: Avg Total Loss: 15.9938 | Avg PrC Loss: 10.3507 | Avg SnC Loss: 44.0216 | Avg FiC Loss: 9.5100 | Avg CE Loss: 0.0930 | Model Sparsity: 0.989Retraining Epoch [3/5]: Avg Total Loss: 15.9801 | Avg PrC Loss: 10.3441 | Avg SnC Loss: 43.9886 | Avg FiC Loss: 9.4983 | Avg CE Loss: 0.0892 | Model Sparsity: 0.989Retraining Epoch [4/5]: Avg Total Loss: 15.9673 | Avg PrC Loss: 10.3450 | Avg SnC Loss: 43.9510 | Avg FiC Loss: 9.4888 | Avg CE Loss: 0.0844 | Model Sparsity: 0.989Retraining Epoch [5/5]: Avg Total Loss: 15.9566 | Avg PrC Loss: 10.3407 | Avg SnC Loss: 43.9238 | Avg FiC Loss: 9.4793 | Avg CE Loss: 0.0826 | Model Sparsity: 0.989Epoch [8/10]: Avg Total Loss: 15.9559 | Avg PrC Loss: 10.3382 | Avg SnC Loss: 43.9292 | Avg FiC Loss: 9.4773 | Avg CE Loss: 0.0790 | Model Sparsity: 0.990
Retraining Epoch [1/5]: Avg Total Loss: 17.4170 | Avg PrC Loss: 10.3457 | Avg SnC Loss: 49.7830 | Avg FiC Loss: 9.4635 | Avg CE Loss: 0.0758 | Model Sparsity: 0.990Retraining Epoch [2/5]: Avg Total Loss: 17.4054 | Avg PrC Loss: 10.3437 | Avg SnC Loss: 49.7487 | Avg FiC Loss: 9.4567 | Avg CE Loss: 0.0724 | Model Sparsity: 0.990Retraining Epoch [3/5]: Avg Total Loss: 17.3957 | Avg PrC Loss: 10.3417 | Avg SnC Loss: 49.7163 | Avg FiC Loss: 9.4538 | Avg CE Loss: 0.0711 | Model Sparsity: 0.990Retraining Epoch [4/5]: Avg Total Loss: 17.3903 | Avg PrC Loss: 10.3427 | Avg SnC Loss: 49.7013 | Avg FiC Loss: 9.4488 | Avg CE Loss: 0.0683 | Model Sparsity: 0.990Retraining Epoch [5/5]: Avg Total Loss: 17.3784 | Avg PrC Loss: 10.3416 | Avg SnC Loss: 49.6669 | Avg FiC Loss: 9.4384 | Avg CE Loss: 0.0668 | Model Sparsity: 0.990Epoch [9/10]: Avg Total Loss: 17.3776 | Avg PrC Loss: 10.3401 | Avg SnC Loss: 49.6677 | Avg FiC Loss: 9.4379 | Avg CE Loss: 0.0648 | Model Sparsity: 0.990
Retraining Epoch [1/5]: Avg Total Loss: 18.8293 | Avg PrC Loss: 10.3437 | Avg SnC Loss: 55.4819 | Avg FiC Loss: 9.4290 | Avg CE Loss: 0.0628 | Model Sparsity: 0.990Retraining Epoch [2/5]: Avg Total Loss: 18.8218 | Avg PrC Loss: 10.3416 | Avg SnC Loss: 55.4597 | Avg FiC Loss: 9.4252 | Avg CE Loss: 0.0608 | Model Sparsity: 0.990Retraining Epoch [3/5]: Avg Total Loss: 18.8222 | Avg PrC Loss: 10.3399 | Avg SnC Loss: 55.4661 | Avg FiC Loss: 9.4222 | Avg CE Loss: 0.0605 | Model Sparsity: 0.990Retraining Epoch [4/5]: Avg Total Loss: 18.8123 | Avg PrC Loss: 10.3405 | Avg SnC Loss: 55.4383 | Avg FiC Loss: 9.4127 | Avg CE Loss: 0.0578 | Model Sparsity: 0.990Retraining Epoch [5/5]: Avg Total Loss: 18.8059 | Avg PrC Loss: 10.3394 | Avg SnC Loss: 55.4211 | Avg FiC Loss: 9.4070 | Avg CE Loss: 0.0559 | Model Sparsity: 0.990Epoch [10/10]: Avg Total Loss: 18.8077 | Avg PrC Loss: 10.3402 | Avg SnC Loss: 55.4240 | Avg FiC Loss: 9.4111 | Avg CE Loss: 0.0556 | Model Sparsity: 0.990
