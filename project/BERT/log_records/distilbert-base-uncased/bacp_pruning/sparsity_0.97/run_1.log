Model : distilbert-base-uncased - Learning Type: bacp_pruning/sparsity_0.97
Configuration:
model_type: llm
model_name: distilbert-base-uncased
model_task: sst2
epochs: 10
pruning_epochs: 10
recovery_epochs: 5
batch_size: 64
learning_rate: 1e-05
pruning_type: magnitude_pruning
target_sparsity: 0.97
n_views: 2
temperature: 0.07
base_temperature: 0.07
num_classes: 2
lambda1: 0.25
lambda2: 0.25
lambda3: 0.25
lambda4: 0.25
embedding_dim: 768
save_path: {'current_model': '/dbfs/research/distilbert-base-uncased/sst2/distilbert-base-uncased_magnitude_pruning_0.97_bacp_cm.pt', 'pretrained_model': '/dbfs/research/distilbert-base-uncased/sst2/distilbert-base-uncased_magnitude_pruning_0.97_bacp_pm.pt', 'finetuned_model': '/dbfs/research/distilbert-base-uncased/sst2/distilbert-base-uncased_magnitude_pruning_0.97_bacp_fm.pt'}

Epoch [1/10]: Avg Total Loss: 5.5145 | Avg PrC Loss: 10.5674 | Avg SnC Loss: 0.0000 | Avg FiC Loss: 10.8340 | Avg CE Loss: 0.6568 | Model Sparsity: 0.097
Retraining Epoch [1/5]: Avg Total Loss: 6.9195 | Avg PrC Loss: 10.5106 | Avg SnC Loss: 6.4587 | Avg FiC Loss: 10.1608 | Avg CE Loss: 0.5481 | Model Sparsity: 0.097Retraining Epoch [2/5]: Avg Total Loss: 6.8155 | Avg PrC Loss: 10.4842 | Avg SnC Loss: 6.3976 | Avg FiC Loss: 9.9641 | Avg CE Loss: 0.4160 | Model Sparsity: 0.097Retraining Epoch [3/5]: Avg Total Loss: 6.7551 | Avg PrC Loss: 10.4676 | Avg SnC Loss: 6.3822 | Avg FiC Loss: 9.8694 | Avg CE Loss: 0.3012 | Model Sparsity: 0.097Retraining Epoch [4/5]: Avg Total Loss: 6.7135 | Avg PrC Loss: 10.4557 | Avg SnC Loss: 6.3681 | Avg FiC Loss: 9.8064 | Avg CE Loss: 0.2240 | Model Sparsity: 0.097Retraining Epoch [5/5]: Avg Total Loss: 6.6825 | Avg PrC Loss: 10.4389 | Avg SnC Loss: 6.3599 | Avg FiC Loss: 9.7569 | Avg CE Loss: 0.1743 | Model Sparsity: 0.097Epoch [2/10]: Avg Total Loss: 6.6626 | Avg PrC Loss: 10.4286 | Avg SnC Loss: 6.3633 | Avg FiC Loss: 9.7215 | Avg CE Loss: 0.1369 | Model Sparsity: 0.194
Retraining Epoch [1/5]: Avg Total Loss: 8.1201 | Avg PrC Loss: 10.4296 | Avg SnC Loss: 12.2501 | Avg FiC Loss: 9.6882 | Avg CE Loss: 0.1123 | Model Sparsity: 0.194Retraining Epoch [2/5]: Avg Total Loss: 8.1042 | Avg PrC Loss: 10.4193 | Avg SnC Loss: 12.2321 | Avg FiC Loss: 9.6709 | Avg CE Loss: 0.0946 | Model Sparsity: 0.194Retraining Epoch [3/5]: Avg Total Loss: 8.0894 | Avg PrC Loss: 10.4135 | Avg SnC Loss: 12.2146 | Avg FiC Loss: 9.6491 | Avg CE Loss: 0.0806 | Model Sparsity: 0.194Retraining Epoch [4/5]: Avg Total Loss: 8.0772 | Avg PrC Loss: 10.4028 | Avg SnC Loss: 12.2021 | Avg FiC Loss: 9.6347 | Avg CE Loss: 0.0693 | Model Sparsity: 0.194Retraining Epoch [5/5]: Avg Total Loss: 8.0692 | Avg PrC Loss: 10.4015 | Avg SnC Loss: 12.1925 | Avg FiC Loss: 9.6224 | Avg CE Loss: 0.0604 | Model Sparsity: 0.194Epoch [3/10]: Avg Total Loss: 8.0712 | Avg PrC Loss: 10.3997 | Avg SnC Loss: 12.2054 | Avg FiC Loss: 9.6242 | Avg CE Loss: 0.0554 | Model Sparsity: 0.291
Retraining Epoch [1/5]: Avg Total Loss: 9.5126 | Avg PrC Loss: 10.4022 | Avg SnC Loss: 17.9998 | Avg FiC Loss: 9.5992 | Avg CE Loss: 0.0490 | Model Sparsity: 0.291Retraining Epoch [2/5]: Avg Total Loss: 9.5028 | Avg PrC Loss: 10.3985 | Avg SnC Loss: 17.9801 | Avg FiC Loss: 9.5908 | Avg CE Loss: 0.0420 | Model Sparsity: 0.291Retraining Epoch [3/5]: Avg Total Loss: 9.4939 | Avg PrC Loss: 10.3949 | Avg SnC Loss: 17.9600 | Avg FiC Loss: 9.5829 | Avg CE Loss: 0.0379 | Model Sparsity: 0.291Retraining Epoch [4/5]: Avg Total Loss: 9.4887 | Avg PrC Loss: 10.3916 | Avg SnC Loss: 17.9537 | Avg FiC Loss: 9.5753 | Avg CE Loss: 0.0344 | Model Sparsity: 0.291Retraining Epoch [5/5]: Avg Total Loss: 9.4857 | Avg PrC Loss: 10.3934 | Avg SnC Loss: 17.9469 | Avg FiC Loss: 9.5705 | Avg CE Loss: 0.0322 | Model Sparsity: 0.291Epoch [4/10]: Avg Total Loss: 9.5027 | Avg PrC Loss: 10.3973 | Avg SnC Loss: 17.9997 | Avg FiC Loss: 9.5792 | Avg CE Loss: 0.0345 | Model Sparsity: 0.388
Retraining Epoch [1/5]: Avg Total Loss: 10.9388 | Avg PrC Loss: 10.4044 | Avg SnC Loss: 23.7501 | Avg FiC Loss: 9.5697 | Avg CE Loss: 0.0312 | Model Sparsity: 0.388Retraining Epoch [2/5]: Avg Total Loss: 10.9294 | Avg PrC Loss: 10.4059 | Avg SnC Loss: 23.7247 | Avg FiC Loss: 9.5594 | Avg CE Loss: 0.0274 | Model Sparsity: 0.388Retraining Epoch [3/5]: Avg Total Loss: 10.9202 | Avg PrC Loss: 10.3981 | Avg SnC Loss: 23.7116 | Avg FiC Loss: 9.5468 | Avg CE Loss: 0.0242 | Model Sparsity: 0.388Retraining Epoch [4/5]: Avg Total Loss: 10.9145 | Avg PrC Loss: 10.3952 | Avg SnC Loss: 23.6942 | Avg FiC Loss: 9.5462 | Avg CE Loss: 0.0226 | Model Sparsity: 0.388Retraining Epoch [5/5]: Avg Total Loss: 10.9114 | Avg PrC Loss: 10.3949 | Avg SnC Loss: 23.6890 | Avg FiC Loss: 9.5402 | Avg CE Loss: 0.0216 | Model Sparsity: 0.388Epoch [5/10]: Avg Total Loss: 10.9526 | Avg PrC Loss: 10.4085 | Avg SnC Loss: 23.8032 | Avg FiC Loss: 9.5710 | Avg CE Loss: 0.0278 | Model Sparsity: 0.485
Retraining Epoch [1/5]: Avg Total Loss: 12.3904 | Avg PrC Loss: 10.4251 | Avg SnC Loss: 29.5540 | Avg FiC Loss: 9.5562 | Avg CE Loss: 0.0264 | Model Sparsity: 0.485Retraining Epoch [2/5]: Avg Total Loss: 12.3707 | Avg PrC Loss: 10.4137 | Avg SnC Loss: 29.5017 | Avg FiC Loss: 9.5459 | Avg CE Loss: 0.0214 | Model Sparsity: 0.485Retraining Epoch [3/5]: Avg Total Loss: 12.3633 | Avg PrC Loss: 10.4118 | Avg SnC Loss: 29.4832 | Avg FiC Loss: 9.5383 | Avg CE Loss: 0.0199 | Model Sparsity: 0.485Retraining Epoch [4/5]: Avg Total Loss: 12.3579 | Avg PrC Loss: 10.4108 | Avg SnC Loss: 29.4638 | Avg FiC Loss: 9.5385 | Avg CE Loss: 0.0186 | Model Sparsity: 0.485Retraining Epoch [5/5]: Avg Total Loss: 12.3524 | Avg PrC Loss: 10.4044 | Avg SnC Loss: 29.4496 | Avg FiC Loss: 9.5384 | Avg CE Loss: 0.0170 | Model Sparsity: 0.485Epoch [6/10]: Avg Total Loss: 12.4309 | Avg PrC Loss: 10.4277 | Avg SnC Loss: 29.6833 | Avg FiC Loss: 9.5818 | Avg CE Loss: 0.0307 | Model Sparsity: 0.582
Retraining Epoch [1/5]: Avg Total Loss: 13.8684 | Avg PrC Loss: 10.4413 | Avg SnC Loss: 35.4307 | Avg FiC Loss: 9.5728 | Avg CE Loss: 0.0289 | Model Sparsity: 0.582Retraining Epoch [2/5]: Avg Total Loss: 13.8371 | Avg PrC Loss: 10.4364 | Avg SnC Loss: 35.3442 | Avg FiC Loss: 9.5458 | Avg CE Loss: 0.0222 | Model Sparsity: 0.582Retraining Epoch [3/5]: Avg Total Loss: 13.8254 | Avg PrC Loss: 10.4349 | Avg SnC Loss: 35.3069 | Avg FiC Loss: 9.5401 | Avg CE Loss: 0.0197 | Model Sparsity: 0.582Retraining Epoch [4/5]: Avg Total Loss: 13.8190 | Avg PrC Loss: 10.4330 | Avg SnC Loss: 35.2873 | Avg FiC Loss: 9.5374 | Avg CE Loss: 0.0184 | Model Sparsity: 0.582Retraining Epoch [5/5]: Avg Total Loss: 13.8116 | Avg PrC Loss: 10.4286 | Avg SnC Loss: 35.2596 | Avg FiC Loss: 9.5404 | Avg CE Loss: 0.0180 | Model Sparsity: 0.582Epoch [7/10]: Avg Total Loss: 13.9615 | Avg PrC Loss: 10.4525 | Avg SnC Loss: 35.7273 | Avg FiC Loss: 9.6258 | Avg CE Loss: 0.0403 | Model Sparsity: 0.679
Retraining Epoch [1/5]: Avg Total Loss: 15.4084 | Avg PrC Loss: 10.4746 | Avg SnC Loss: 41.5060 | Avg FiC Loss: 9.6135 | Avg CE Loss: 0.0396 | Model Sparsity: 0.679Retraining Epoch [2/5]: Avg Total Loss: 15.3578 | Avg PrC Loss: 10.4660 | Avg SnC Loss: 41.3558 | Avg FiC Loss: 9.5788 | Avg CE Loss: 0.0306 | Model Sparsity: 0.679Retraining Epoch [3/5]: Avg Total Loss: 15.3364 | Avg PrC Loss: 10.4645 | Avg SnC Loss: 41.2836 | Avg FiC Loss: 9.5704 | Avg CE Loss: 0.0271 | Model Sparsity: 0.679Retraining Epoch [4/5]: Avg Total Loss: 15.3189 | Avg PrC Loss: 10.4642 | Avg SnC Loss: 41.2303 | Avg FiC Loss: 9.5579 | Avg CE Loss: 0.0232 | Model Sparsity: 0.679Retraining Epoch [5/5]: Avg Total Loss: 15.3052 | Avg PrC Loss: 10.4553 | Avg SnC Loss: 41.1912 | Avg FiC Loss: 9.5533 | Avg CE Loss: 0.0210 | Model Sparsity: 0.679Epoch [8/10]: Avg Total Loss: 15.6513 | Avg PrC Loss: 10.4996 | Avg SnC Loss: 42.2879 | Avg FiC Loss: 9.7485 | Avg CE Loss: 0.0693 | Model Sparsity: 0.776
Retraining Epoch [1/5]: Avg Total Loss: 17.1148 | Avg PrC Loss: 10.5192 | Avg SnC Loss: 48.1391 | Avg FiC Loss: 9.7317 | Avg CE Loss: 0.0695 | Model Sparsity: 0.776Retraining Epoch [2/5]: Avg Total Loss: 17.0128 | Avg PrC Loss: 10.5171 | Avg SnC Loss: 47.8157 | Avg FiC Loss: 9.6652 | Avg CE Loss: 0.0532 | Model Sparsity: 0.776Retraining Epoch [3/5]: Avg Total Loss: 16.9555 | Avg PrC Loss: 10.5128 | Avg SnC Loss: 47.6348 | Avg FiC Loss: 9.6290 | Avg CE Loss: 0.0452 | Model Sparsity: 0.776Retraining Epoch [4/5]: Avg Total Loss: 16.9206 | Avg PrC Loss: 10.5073 | Avg SnC Loss: 47.5222 | Avg FiC Loss: 9.6133 | Avg CE Loss: 0.0397 | Model Sparsity: 0.776Retraining Epoch [5/5]: Avg Total Loss: 16.8976 | Avg PrC Loss: 10.5032 | Avg SnC Loss: 47.4444 | Avg FiC Loss: 9.6066 | Avg CE Loss: 0.0362 | Model Sparsity: 0.776Epoch [9/10]: Avg Total Loss: 17.7440 | Avg PrC Loss: 10.5860 | Avg SnC Loss: 50.2540 | Avg FiC Loss: 10.0114 | Avg CE Loss: 0.1245 | Model Sparsity: 0.873
Retraining Epoch [1/5]: Avg Total Loss: 19.2988 | Avg PrC Loss: 10.5965 | Avg SnC Loss: 56.4202 | Avg FiC Loss: 10.0371 | Avg CE Loss: 0.1412 | Model Sparsity: 0.873Retraining Epoch [2/5]: Avg Total Loss: 19.0416 | Avg PrC Loss: 10.5906 | Avg SnC Loss: 55.5648 | Avg FiC Loss: 9.8996 | Avg CE Loss: 0.1112 | Model Sparsity: 0.873Retraining Epoch [3/5]: Avg Total Loss: 18.9176 | Avg PrC Loss: 10.5852 | Avg SnC Loss: 55.1529 | Avg FiC Loss: 9.8359 | Avg CE Loss: 0.0963 | Model Sparsity: 0.873Retraining Epoch [4/5]: Avg Total Loss: 18.8289 | Avg PrC Loss: 10.5806 | Avg SnC Loss: 54.8585 | Avg FiC Loss: 9.7916 | Avg CE Loss: 0.0851 | Model Sparsity: 0.873Retraining Epoch [5/5]: Avg Total Loss: 18.7601 | Avg PrC Loss: 10.5706 | Avg SnC Loss: 54.6359 | Avg FiC Loss: 9.7573 | Avg CE Loss: 0.0767 | Model Sparsity: 0.873Epoch [10/10]: Avg Total Loss: 21.5073 | Avg PrC Loss: 10.7664 | Avg SnC Loss: 64.3091 | Avg FiC Loss: 10.6510 | Avg CE Loss: 0.3026 | Model Sparsity: 0.970
Retraining Epoch [1/5]: Avg Total Loss: 23.4648 | Avg PrC Loss: 10.8399 | Avg SnC Loss: 71.8060 | Avg FiC Loss: 10.7748 | Avg CE Loss: 0.4386 | Model Sparsity: 0.970Retraining Epoch [2/5]: Avg Total Loss: 22.7248 | Avg PrC Loss: 10.7927 | Avg SnC Loss: 69.1213 | Avg FiC Loss: 10.5916 | Avg CE Loss: 0.3935 | Model Sparsity: 0.970Retraining Epoch [3/5]: Avg Total Loss: 22.3109 | Avg PrC Loss: 10.7601 | Avg SnC Loss: 67.6359 | Avg FiC Loss: 10.4894 | Avg CE Loss: 0.3581 | Model Sparsity: 0.970Retraining Epoch [4/5]: Avg Total Loss: 22.0244 | Avg PrC Loss: 10.7355 | Avg SnC Loss: 66.6250 | Avg FiC Loss: 10.4107 | Avg CE Loss: 0.3265 | Model Sparsity: 0.970Retraining Epoch [5/5]: Avg Total Loss: 21.8090 | Avg PrC Loss: 10.7127 | Avg SnC Loss: 65.8786 | Avg FiC Loss: 10.3465 | Avg CE Loss: 0.2983 | Model Sparsity: 0.970