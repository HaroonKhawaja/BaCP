Model : roberta-base - Learning Type: bacp_pruning/sparsity_0.95
Configuration:
model_type: llm
model_name: roberta-base
model_task: sst2
epochs: 10
pruning_epochs: 10
recovery_epochs: 5
batch_size: 64
learning_rate: 1e-05
pruning_type: magnitude_pruning
target_sparsity: 0.95
n_views: 2
temperature: 0.07
base_temperature: 0.07
num_classes: 2
lambda1: 0.25
lambda2: 0.25
lambda3: 0.25
lambda4: 0.25
embedding_dim: 768
save_path: {'current_model': '/dbfs/research/roberta-base/sst2/roberta-base_magnitude_pruning_0.95_bacp_cm.pt', 'pretrained_model': '/dbfs/research/roberta-base/sst2/roberta-base_magnitude_pruning_0.95_bacp_pm.pt', 'finetuned_model': '/dbfs/research/roberta-base/sst2/roberta-base_magnitude_pruning_0.95_bacp_fm.pt'}

Epoch [1/10]: Avg Total Loss: 5.5677 | Avg PrC Loss: 10.8106 | Avg SnC Loss: 0.0000 | Avg FiC Loss: 10.8085 | Avg CE Loss: 0.6519 | Model Sparsity: 0.095
Retraining Epoch [1/5]: Avg Total Loss: 7.5606 | Avg PrC Loss: 10.7519 | Avg SnC Loss: 8.1754 | Avg FiC Loss: 10.7461 | Avg CE Loss: 0.5689 | Model Sparsity: 0.095Retraining Epoch [2/5]: Avg Total Loss: 7.5261 | Avg PrC Loss: 10.7423 | Avg SnC Loss: 8.0945 | Avg FiC Loss: 10.7389 | Avg CE Loss: 0.5289 | Model Sparsity: 0.095Retraining Epoch [3/5]: Avg Total Loss: 7.5075 | Avg PrC Loss: 10.7423 | Avg SnC Loss: 8.0615 | Avg FiC Loss: 10.7197 | Avg CE Loss: 0.5066 | Model Sparsity: 0.095Retraining Epoch [4/5]: Avg Total Loss: 7.5052 | Avg PrC Loss: 10.7312 | Avg SnC Loss: 8.0435 | Avg FiC Loss: 10.7535 | Avg CE Loss: 0.4926 | Model Sparsity: 0.095Retraining Epoch [5/5]: Avg Total Loss: 7.4898 | Avg PrC Loss: 10.7260 | Avg SnC Loss: 8.0308 | Avg FiC Loss: 10.7190 | Avg CE Loss: 0.4832 | Model Sparsity: 0.095Epoch [2/10]: Avg Total Loss: 7.4882 | Avg PrC Loss: 10.7368 | Avg SnC Loss: 8.0294 | Avg FiC Loss: 10.7129 | Avg CE Loss: 0.4738 | Model Sparsity: 0.190
Retraining Epoch [1/5]: Avg Total Loss: 9.2862 | Avg PrC Loss: 10.7650 | Avg SnC Loss: 15.1218 | Avg FiC Loss: 10.7721 | Avg CE Loss: 0.4858 | Model Sparsity: 0.190Retraining Epoch [2/5]: Avg Total Loss: 9.2658 | Avg PrC Loss: 10.7539 | Avg SnC Loss: 15.0798 | Avg FiC Loss: 10.7460 | Avg CE Loss: 0.4837 | Model Sparsity: 0.190Retraining Epoch [3/5]: Avg Total Loss: 9.2561 | Avg PrC Loss: 10.7155 | Avg SnC Loss: 15.0608 | Avg FiC Loss: 10.7681 | Avg CE Loss: 0.4801 | Model Sparsity: 0.190Retraining Epoch [4/5]: Avg Total Loss: 9.2494 | Avg PrC Loss: 10.7338 | Avg SnC Loss: 15.0449 | Avg FiC Loss: 10.7425 | Avg CE Loss: 0.4766 | Model Sparsity: 0.190Retraining Epoch [5/5]: Avg Total Loss: 9.2476 | Avg PrC Loss: 10.7469 | Avg SnC Loss: 15.0306 | Avg FiC Loss: 10.7395 | Avg CE Loss: 0.4735 | Model Sparsity: 0.190Epoch [3/10]: Avg Total Loss: 9.2591 | Avg PrC Loss: 10.7649 | Avg SnC Loss: 15.0538 | Avg FiC Loss: 10.7453 | Avg CE Loss: 0.4724 | Model Sparsity: 0.285
Retraining Epoch [1/5]: Avg Total Loss: 10.9336 | Avg PrC Loss: 10.7799 | Avg SnC Loss: 21.6600 | Avg FiC Loss: 10.8147 | Avg CE Loss: 0.4798 | Model Sparsity: 0.285Retraining Epoch [2/5]: Avg Total Loss: 10.9297 | Avg PrC Loss: 10.8026 | Avg SnC Loss: 21.6266 | Avg FiC Loss: 10.8099 | Avg CE Loss: 0.4797 | Model Sparsity: 0.285Retraining Epoch [3/5]: Avg Total Loss: 10.9302 | Avg PrC Loss: 10.8173 | Avg SnC Loss: 21.6059 | Avg FiC Loss: 10.8200 | Avg CE Loss: 0.4774 | Model Sparsity: 0.285Retraining Epoch [4/5]: Avg Total Loss: 10.9220 | Avg PrC Loss: 10.8024 | Avg SnC Loss: 21.5898 | Avg FiC Loss: 10.8199 | Avg CE Loss: 0.4759 | Model Sparsity: 0.285Retraining Epoch [5/5]: Avg Total Loss: 10.9256 | Avg PrC Loss: 10.8284 | Avg SnC Loss: 21.5781 | Avg FiC Loss: 10.8221 | Avg CE Loss: 0.4738 | Model Sparsity: 0.285Epoch [4/10]: Avg Total Loss: 10.9303 | Avg PrC Loss: 10.7986 | Avg SnC Loss: 21.6584 | Avg FiC Loss: 10.7892 | Avg CE Loss: 0.4750 | Model Sparsity: 0.380
Retraining Epoch [1/5]: Avg Total Loss: 12.5542 | Avg PrC Loss: 10.8620 | Avg SnC Loss: 28.0074 | Avg FiC Loss: 10.8674 | Avg CE Loss: 0.4801 | Model Sparsity: 0.380Retraining Epoch [2/5]: Avg Total Loss: 12.5368 | Avg PrC Loss: 10.8595 | Avg SnC Loss: 27.9646 | Avg FiC Loss: 10.8436 | Avg CE Loss: 0.4796 | Model Sparsity: 0.380Retraining Epoch [3/5]: Avg Total Loss: 12.5371 | Avg PrC Loss: 10.8703 | Avg SnC Loss: 27.9438 | Avg FiC Loss: 10.8561 | Avg CE Loss: 0.4781 | Model Sparsity: 0.380Retraining Epoch [4/5]: Avg Total Loss: 12.5337 | Avg PrC Loss: 10.8692 | Avg SnC Loss: 27.9250 | Avg FiC Loss: 10.8642 | Avg CE Loss: 0.4766 | Model Sparsity: 0.380Retraining Epoch [5/5]: Avg Total Loss: 12.5239 | Avg PrC Loss: 10.8615 | Avg SnC Loss: 27.9066 | Avg FiC Loss: 10.8522 | Avg CE Loss: 0.4752 | Model Sparsity: 0.380Epoch [5/10]: Avg Total Loss: 12.5680 | Avg PrC Loss: 10.8551 | Avg SnC Loss: 28.0829 | Avg FiC Loss: 10.8538 | Avg CE Loss: 0.4802 | Model Sparsity: 0.475
Retraining Epoch [1/5]: Avg Total Loss: 14.1553 | Avg PrC Loss: 10.9354 | Avg SnC Loss: 34.2866 | Avg FiC Loss: 10.9155 | Avg CE Loss: 0.4837 | Model Sparsity: 0.475Retraining Epoch [2/5]: Avg Total Loss: 14.1310 | Avg PrC Loss: 10.9021 | Avg SnC Loss: 34.2147 | Avg FiC Loss: 10.9251 | Avg CE Loss: 0.4823 | Model Sparsity: 0.475Retraining Epoch [3/5]: Avg Total Loss: 14.1131 | Avg PrC Loss: 10.9028 | Avg SnC Loss: 34.1787 | Avg FiC Loss: 10.8901 | Avg CE Loss: 0.4808 | Model Sparsity: 0.475Retraining Epoch [4/5]: Avg Total Loss: 14.1190 | Avg PrC Loss: 10.9238 | Avg SnC Loss: 34.1584 | Avg FiC Loss: 10.9138 | Avg CE Loss: 0.4801 | Model Sparsity: 0.475Retraining Epoch [5/5]: Avg Total Loss: 14.1073 | Avg PrC Loss: 10.9184 | Avg SnC Loss: 34.1276 | Avg FiC Loss: 10.9049 | Avg CE Loss: 0.4784 | Model Sparsity: 0.475Epoch [6/10]: Avg Total Loss: 14.2124 | Avg PrC Loss: 10.9224 | Avg SnC Loss: 34.5075 | Avg FiC Loss: 10.9309 | Avg CE Loss: 0.4888 | Model Sparsity: 0.570
Retraining Epoch [1/5]: Avg Total Loss: 15.7725 | Avg PrC Loss: 10.9433 | Avg SnC Loss: 40.6717 | Avg FiC Loss: 10.9830 | Avg CE Loss: 0.4918 | Model Sparsity: 0.570Retraining Epoch [2/5]: Avg Total Loss: 15.7387 | Avg PrC Loss: 10.9487 | Avg SnC Loss: 40.5391 | Avg FiC Loss: 10.9783 | Avg CE Loss: 0.4888 | Model Sparsity: 0.570Retraining Epoch [3/5]: Avg Total Loss: 15.7145 | Avg PrC Loss: 10.9436 | Avg SnC Loss: 40.4755 | Avg FiC Loss: 10.9526 | Avg CE Loss: 0.4860 | Model Sparsity: 0.570Retraining Epoch [4/5]: Avg Total Loss: 15.7163 | Avg PrC Loss: 10.9760 | Avg SnC Loss: 40.4339 | Avg FiC Loss: 10.9704 | Avg CE Loss: 0.4847 | Model Sparsity: 0.570Retraining Epoch [5/5]: Avg Total Loss: 15.6983 | Avg PrC Loss: 10.9533 | Avg SnC Loss: 40.4086 | Avg FiC Loss: 10.9474 | Avg CE Loss: 0.4841 | Model Sparsity: 0.570Epoch [7/10]: Avg Total Loss: 15.9110 | Avg PrC Loss: 10.9759 | Avg SnC Loss: 41.1996 | Avg FiC Loss: 10.9674 | Avg CE Loss: 0.5011 | Model Sparsity: 0.665
Retraining Epoch [1/5]: Avg Total Loss: 17.4865 | Avg PrC Loss: 11.0097 | Avg SnC Loss: 47.4079 | Avg FiC Loss: 11.0221 | Avg CE Loss: 0.5064 | Model Sparsity: 0.665Retraining Epoch [2/5]: Avg Total Loss: 17.4133 | Avg PrC Loss: 10.9945 | Avg SnC Loss: 47.1551 | Avg FiC Loss: 11.0026 | Avg CE Loss: 0.5011 | Model Sparsity: 0.665Retraining Epoch [3/5]: Avg Total Loss: 17.3918 | Avg PrC Loss: 11.0114 | Avg SnC Loss: 47.0237 | Avg FiC Loss: 11.0346 | Avg CE Loss: 0.4976 | Model Sparsity: 0.665Retraining Epoch [4/5]: Avg Total Loss: 17.3640 | Avg PrC Loss: 11.0100 | Avg SnC Loss: 46.9445 | Avg FiC Loss: 11.0063 | Avg CE Loss: 0.4953 | Model Sparsity: 0.665Retraining Epoch [5/5]: Avg Total Loss: 17.3402 | Avg PrC Loss: 11.0009 | Avg SnC Loss: 46.8667 | Avg FiC Loss: 10.9997 | Avg CE Loss: 0.4933 | Model Sparsity: 0.665Epoch [8/10]: Avg Total Loss: 17.8011 | Avg PrC Loss: 11.0203 | Avg SnC Loss: 48.6407 | Avg FiC Loss: 11.0138 | Avg CE Loss: 0.5295 | Model Sparsity: 0.760
Retraining Epoch [1/5]: Avg Total Loss: 19.4217 | Avg PrC Loss: 11.0641 | Avg SnC Loss: 55.0240 | Avg FiC Loss: 11.0568 | Avg CE Loss: 0.5419 | Model Sparsity: 0.760Retraining Epoch [2/5]: Avg Total Loss: 19.2970 | Avg PrC Loss: 11.0546 | Avg SnC Loss: 54.5352 | Avg FiC Loss: 11.0668 | Avg CE Loss: 0.5313 | Model Sparsity: 0.760Retraining Epoch [3/5]: Avg Total Loss: 19.2297 | Avg PrC Loss: 11.0504 | Avg SnC Loss: 54.2799 | Avg FiC Loss: 11.0641 | Avg CE Loss: 0.5246 | Model Sparsity: 0.760Retraining Epoch [4/5]: Avg Total Loss: 19.1797 | Avg PrC Loss: 11.0520 | Avg SnC Loss: 54.0919 | Avg FiC Loss: 11.0553 | Avg CE Loss: 0.5196 | Model Sparsity: 0.760Retraining Epoch [5/5]: Avg Total Loss: 19.1432 | Avg PrC Loss: 11.0496 | Avg SnC Loss: 53.9519 | Avg FiC Loss: 11.0555 | Avg CE Loss: 0.5159 | Model Sparsity: 0.760Epoch [9/10]: Avg Total Loss: 20.1314 | Avg PrC Loss: 11.0847 | Avg SnC Loss: 57.7850 | Avg FiC Loss: 11.0777 | Avg CE Loss: 0.5781 | Model Sparsity: 0.855
Retraining Epoch [1/5]: Avg Total Loss: 21.8907 | Avg PrC Loss: 11.1264 | Avg SnC Loss: 64.6926 | Avg FiC Loss: 11.1337 | Avg CE Loss: 0.6100 | Model Sparsity: 0.855Retraining Epoch [2/5]: Avg Total Loss: 21.6150 | Avg PrC Loss: 11.1286 | Avg SnC Loss: 63.6324 | Avg FiC Loss: 11.1041 | Avg CE Loss: 0.5950 | Model Sparsity: 0.855Retraining Epoch [3/5]: Avg Total Loss: 21.4726 | Avg PrC Loss: 11.1030 | Avg SnC Loss: 63.1020 | Avg FiC Loss: 11.1000 | Avg CE Loss: 0.5855 | Model Sparsity: 0.855Retraining Epoch [4/5]: Avg Total Loss: 21.3773 | Avg PrC Loss: 11.0968 | Avg SnC Loss: 62.7219 | Avg FiC Loss: 11.1130 | Avg CE Loss: 0.5775 | Model Sparsity: 0.855Retraining Epoch [5/5]: Avg Total Loss: 21.3003 | Avg PrC Loss: 11.1058 | Avg SnC Loss: 62.4178 | Avg FiC Loss: 11.1065 | Avg CE Loss: 0.5712 | Model Sparsity: 0.855Epoch [10/10]: Avg Total Loss: 24.1278 | Avg PrC Loss: 11.0628 | Avg SnC Loss: 73.7585 | Avg FiC Loss: 11.0584 | Avg CE Loss: 0.6313 | Model Sparsity: 0.950
Retraining Epoch [1/5]: Avg Total Loss: 27.0165 | Avg PrC Loss: 11.0743 | Avg SnC Loss: 85.2411 | Avg FiC Loss: 11.0611 | Avg CE Loss: 0.6894 | Model Sparsity: 0.950Retraining Epoch [2/5]: Avg Total Loss: 26.1479 | Avg PrC Loss: 11.0903 | Avg SnC Loss: 81.7279 | Avg FiC Loss: 11.0851 | Avg CE Loss: 0.6885 | Model Sparsity: 0.950Retraining Epoch [3/5]: Avg Total Loss: 25.7296 | Avg PrC Loss: 11.1041 | Avg SnC Loss: 80.0128 | Avg FiC Loss: 11.1138 | Avg CE Loss: 0.6878 | Model Sparsity: 0.950Retraining Epoch [4/5]: Avg Total Loss: 25.4292 | Avg PrC Loss: 11.0964 | Avg SnC Loss: 78.8137 | Avg FiC Loss: 11.1196 | Avg CE Loss: 0.6870 | Model Sparsity: 0.950Retraining Epoch [5/5]: Avg Total Loss: 25.1967 | Avg PrC Loss: 11.1162 | Avg SnC Loss: 77.8793 | Avg FiC Loss: 11.1051 | Avg CE Loss: 0.6862 | Model Sparsity: 0.950